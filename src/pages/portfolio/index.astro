---
import { Image } from 'astro:assets'
import BaseLayout from '../../layouts/BaseLayout.astro'
import { getCollection } from 'astro:content'
import BgImg from '../../images/bg.png'

const projects = (await getCollection('projects')).sort(
  (a, b) => new Date(b.data.endDate).getTime() - new Date(a.data.endDate).getTime()
)
---

<BaseLayout
  title="Portfolio"
  description="Front-end projects and selected work"
>
  <div class="relative min-h-[calc(100vh-200px)]">
    <div class="absolute inset-0">
      <Image
        class="h-full w-full object-cover object-top"
        src={BgImg}
        alt=""
      />
      <div aria-hidden="true" class="absolute inset-0 bg-black/70"></div>
    </div>

    <section class="relative mx-auto max-w-6xl px-4 py-10 sm:px-6">
      <div class="mx-auto max-w-2xl">
      <h1 class="text-3xl font-semibold tracking-tight text-white sm:text-4xl">
        Portfolio
      </h1>
      <p class="mt-3 text-lg text-slate-300">
        Selected client work with a focus on front-end architecture, accessibility, and performance
      </p>
    </div>

    <div class="mt-10 grid gap-6 sm:grid-cols-2">
      {projects.map((entry) => (
        <a
          href={`/portfolio/${entry.slug}`}
          class="group rounded-xl border border-white/10 bg-white/5 p-6 transition hover:bg-white/10"
        >
          <div class="flex items-start justify-between gap-4">
            <div>
              <h2 class="text-lg font-semibold text-white group-hover:text-brown-200">
                {entry.data.title}
              </h2>
              <p class="mt-1 text-sm text-slate-300">{entry.data.client}</p>
            </div>
            {entry.data.nda ? (
              <span class="rounded-full bg-brown-900/40 px-3 py-1 text-xs font-semibold text-brown-200">
                NDA-safe
              </span>
            ) : null}
          </div>

          <p class="mt-4 text-sm text-slate-300">{entry.data.summary}</p>

          <div class="mt-5 flex flex-wrap gap-2">
            {entry.data.stack.slice(0, 4).map((t) => (
              <span class="rounded-md bg-black/40 px-2 py-1 text-xs text-slate-200">
                {t}
              </span>
            ))}
          </div>

          <div class="mt-6 text-sm font-semibold text-brown-300">View project</div>
        </a>
      ))}
    </div>
    </section>
  </div>
</BaseLayout>
